#include <cstdlib>
#include <iostream>
#include <string>
#include <assert.h>
using namespace std;

int KMPStrMatching(string T, string P,  int *N) {
    int i = 0;							// ??????????????
    int j = 0;							// ??????????????
    int pLen = P. length ( );             		// ???????ก่??
    int tLen = T.length( );					// ???????ก่??

    if (tLen < pLen) 				    		// ??????????????????????????????
        return (-1);          			
    while ( i < pLen  &&  j < tLen)  {  		// ??????????????????????????
       		if ( i == -1  ||  T[j] == P[i]) 
    			i++,  j++;
    		else i = N[i];
    }
    if ( i >= pLen)
    		return (j - pLen + 1);
    else return (-1);
}


int *findNext(string P) {
	int i = 0; 
    int k = -1; 
    int m = P.length();    					// m????????P???ก่??
  	assert(m > 0);     					// ??m??0??????
  	int *next = new int[m];  				// ??????????????????????
    assert(next != 0);   					// ????????????????????????
  	next[0] = -1;
    while (i < m) { 						// ????i=1..m-1??next??
		while (k >= 0 && P[i] != P[k])  		// ??????????????
			k = next[k];		
        i++;
		k++;
		if (i == m) break;
		if (P[i] == P[k] ) 				
			next[i] = next[k];				//  P[i]??P[k]??????????
		else next[i] = k;					// ????????????????????i???????????ก่??
    }
    return next;
}

